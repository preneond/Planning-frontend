  <!DOCTYPE html>
  <html>
  <head>
      <meta charset='utf-8' />
      <title>Intermodal Planner</title>
      <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <link rel="stylesheet" href="libraries/awesomplete/awesomplete.css" />
      <script src="libraries/awesomplete/awesomplete.js" async></script>
      <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
      <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
      <style>
          body {
            margin:0;
            padding:0;
          }
          img {
            margin-right: 20px;
          }
          #map {
            position:absolute;
            top:0;
            bottom:0;
            width:100%;
          }
          #search-box {
            position:absolute;
            margin:50px 50px 50px 50px;
            padding: 10px 10px 10px 10px;
            width: 400px;
            height:150px;
            background-color: white;
            border-radius: 15px;
            background: rgba(255,255,255,0.9);
          }
          #search-table {
            position: relative;
            width: 90%;
            height: 100%;
          }
          #search-table tr {
            position: relative;
            height: 50px;
            width: 200px;
          }
          #search-table input {
            position: relative;
            width: 80%;
            height: 80%;
            font-size: 14px;
          }

          #search-table button {
            position: relative;
            width: 100%;
            height: 80%;
            font-size: 14px;
          }
          #planRouteBtn {
            border: none;
            color: white;
            background-color: green;
          }
      </style>
  </head>
  <body>

  <div id='map'></div>

  <div id="search-box">

    <div id="search-input">
      <table id="search-table">
        <tbody>
          <tr>
            <th>
              <input id="originInput" placeholder="Origin place"/>
            </th>
            <th>
                <img id="originMarker" src="img/markers/marker_origin.png" alt="" height=30 />
            </th>
          </tr>
          <tr>
            <th>
              <!-- <input id="placeInput" placeholder="Destination place"/> -->
              <input id="destinationInput" />
              <ul id="autocompleteList" hidden = true>
              	<li>Ada</li>
              	<li>Java</li>
              	<li>JavaScript</li>
              	<li>Brainfuck</li>
              	<li>LOLCODE</li>
              	<li>Node.js</li>
              	<li>Ruby on Rails</li>
              </ul>
            </th>
            <th>
              <img id="destMarker" src="img/markers/marker_destination.png" alt="" height=30 />
            </th>
          </tr>
          <tr>
            <th>
              <img id="carIcon" src="img/transport_modes/car_enabled.png" alt="" height=25 />
              <img id="transitIcon" src="img/transport_modes/transit_enabled.png" alt="" height=25 />
              <img id="bikeIcon" src="img/transport_modes/bike_enabled.png" alt="" height=25 />
              <img id="walkIcon" src="img/transport_modes/walk_enabled.png" alt="" height=25 />
            </th>
            <th>
              <button id="planRouteBtn">Find</button>
            </th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>


  var autoCompleteURL = "https://uc1.umotional.net/geocoding/autocomplete"

  var originMarkEnabled = false;
  var originPicked = false;
  var destinationMarkEnabled = false;
  var destinationPicked = false;

  var carEnabled = true;
  var transitEnabled = true;
  var bikeEnabled = true;
  var walkEnabled = true;

  var carEnabledSrc = "img/transport_modes/car_enabled.png"
  var carDisabledSrc = "img/transport_modes/car_disabled.png"
  var transitEnabledSrc = "img/transport_modes/transit_enabled.png"
  var transitDisabledSrc = "img/transport_modes/transit_disabled.png"
  var bikeEnabledSrc = "img/transport_modes/bike_enabled.png"
  var bikeDisabledSrc = "img/transport_modes/bike_disabled.png"
  var walkEnabledSrc = "img/transport_modes/walk_enabled.png"
  var walkDisabledSrc = "img/transport_modes/walk_disabled.png"

  var carIconElm = document.getElementById("carIcon");
  carIconElm.addEventListener("click",e => modeClicked(e));

  var transitIconElm = document.getElementById("transitIcon");
  transitIconElm.addEventListener("click",e => modeClicked(e));

  var bikeIconElm = document.getElementById("bikeIcon");
  bikeIconElm.addEventListener("click",e => modeClicked(e));

  var walkIconElm = document.getElementById("walkIcon");
  walkIconElm.addEventListener("click",e => modeClicked(e));

  function modeClicked(e) {
    console.log(e.target.id);
    switch (e.target.id) {
      case "carIcon":
        carEnabled = !carEnabled;
        e.target.src = carEnabled ? carEnabledSrc : carDisabledSrc;
        break;
      case "transitIcon":
        transitEnabled = !transitEnabled;
        e.target.src = transitEnabled ? transitEnabledSrc : transitDisabledSrc;
        break;
        case "bikeIcon":
          bikeEnabled = !bikeEnabled;
          e.target.src = bikeEnabled ? bikeEnabledSrc : bikeDisabledSrc;
          break;
        case "walkIcon":
          walkEnabled = !walkEnabled;
          e.target.src = walkEnabled ? walkEnabledSrc : walkDisabledSrc;
          break;
    }
  }

  function autoComplete(e) {
      var text = e.target.value
      if (text.length < 2) return;

      fetch(autoCompleteURL + "?text=" + text)
      .then(response => response.json())
      .then(json => autocompleteListDidChange(e,json));
    }

    function autocompleteListDidChange(e, response) {
      if (e.target.id == "originInput") {
        originComplete.list = response.features.map(feature => feature.properties.label);
        originComplete.evaluate()
      } else {
        destinationComplete.list = response.features.map(feature => feature.properties.label);
        destinationComplete.evaluate()
      }
    }

    mapboxgl.accessToken = 'pk.eyJ1IjoicHJlbmVvbmQiLCJhIjoiY2o1ZGxlbGMxMGxicTJxcnlqMXdoYXZtciJ9.myreL4tEUijFKkauE1ysbA';

    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/mapbox/streets-v9', // stylesheet location
        center: [14.42076, 50.08804], // starting position [lng, lat]
        zoom: 12 // starting zoom
    });

    if ("geolocation" in navigator) {
      navigator.geolocation.getCurrentPosition(position => {
        var location = [position.coords.longitude, position.coords.latitude];
        map.flyTo({center: [position.coords.longitude, position.coords.latitude]});
      });
    } else {
      var location = [14.42076, 50.08804];
    }

    var originInput = document.getElementById("originInput");
    var destinationInput = document.getElementById("destinationInput");

    originInput.addEventListener('input', e => autoComplete(e));

    var originComplete = new Awesomplete(originInput, {});
    var destinationComplete = new Awesomplete(destinationInput, {});

    // var originMarkerElm = document.getElementById("originMarker");
    // originMarkerElm.addEventListener("click",e => markerClicked(e));

    // var destinationMarkerElm = document.getElementById("destinationMarker");
    // originMarkerElm.addEventListener("click",e => markerClicked(e));


  // map.on('load', function () {
      // Center the map on the coordinates of any clicked symbol from the 'symbols' layer.
      // map.on('click', 'symbols', function (e) {
      //     map.flyTo({center: e.features[0].geometry.coordinates});
      // });

      // // Change the cursor to a pointer when the it enters a feature in the 'symbols' layer.
      // map.on('mouseenter', 'symbols', function () {
      //     map.getCanvas().style.cursor = 'pointer';
      // });
      //
      // // Change it back to a pointer when it leaves.
      // map.on('mouseleave', 'symbols', function () {
      //     map.getCanvas().style.cursor = '';
      // });


  //     map.loadImage('https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Cat_silhouette.svg/400px-Cat_silhouette.svg.png', function(error, image) {
  //         if (error) throw error;
  //         map.addImage('cat', image);
  //         map.addLayer({
  //             "id": "points",
  //             "type": "symbol",
  //             "source": {
  //                 "type": "geojson",
  //                 "data": {
  //                     "type": "FeatureCollection",
  //                     "features": [{
  //                         "type": "Feature",
  //                         "geometry": {
  //                             "type": "Point",
  //                             "coordinates": [14.42076, 50.08804]
  //                         }
  //                     }]
  //                 }
  //             },
  //             "layout": {
  //                 "icon-image": "cat",
  //                 "icon-size": 0.25
  //             }
  //         });
  // });
  //
  // });



  // console.log(originComplete._list);

  </script>

  </body>
  </html>
